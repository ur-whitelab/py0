<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API &mdash; py0 0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Quick Start" href="Quick_start.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="toc.html" class="icon icon-home"> py0
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">PY0</a></li>
<li class="toctree-l1"><a class="reference internal" href="Quick_start.html">Quick Start</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#metapopulation-model">metapopulation model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.AddSusceptibleLayer"><code class="docutils literal notranslate"><span class="pre">AddSusceptibleLayer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#py0.metapop_model.AddSusceptibleLayer.call"><code class="docutils literal notranslate"><span class="pre">AddSusceptibleLayer.call()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.ContactInfectionLayer"><code class="docutils literal notranslate"><span class="pre">ContactInfectionLayer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#py0.metapop_model.ContactInfectionLayer.call"><code class="docutils literal notranslate"><span class="pre">ContactInfectionLayer.call()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.DeltaRegularizer"><code class="docutils literal notranslate"><span class="pre">DeltaRegularizer</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.MetaModel"><code class="docutils literal notranslate"><span class="pre">MetaModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#py0.metapop_model.MetaModel.call"><code class="docutils literal notranslate"><span class="pre">MetaModel.call()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.MetaParameterJoint"><code class="docutils literal notranslate"><span class="pre">MetaParameterJoint</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.MetapopLayer"><code class="docutils literal notranslate"><span class="pre">MetapopLayer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#py0.metapop_model.MetapopLayer.build"><code class="docutils literal notranslate"><span class="pre">MetapopLayer.build()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#py0.metapop_model.MetapopLayer.call"><code class="docutils literal notranslate"><span class="pre">MetapopLayer.call()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.MinMaxConstraint"><code class="docutils literal notranslate"><span class="pre">MinMaxConstraint</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.NormalizationConstraint"><code class="docutils literal notranslate"><span class="pre">NormalizationConstraint</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.ParameterHypers"><code class="docutils literal notranslate"><span class="pre">ParameterHypers</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.ParameterJoint"><code class="docutils literal notranslate"><span class="pre">ParameterJoint</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#py0.metapop_model.ParameterJoint.compile"><code class="docutils literal notranslate"><span class="pre">ParameterJoint.compile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#py0.metapop_model.ParameterJoint.sample"><code class="docutils literal notranslate"><span class="pre">ParameterJoint.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.PositiveMaskedConstraint"><code class="docutils literal notranslate"><span class="pre">PositiveMaskedConstraint</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.TrainableInputLayer"><code class="docutils literal notranslate"><span class="pre">TrainableInputLayer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#py0.metapop_model.TrainableInputLayer.call"><code class="docutils literal notranslate"><span class="pre">TrainableInputLayer.call()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.TrainableMetaModel"><code class="docutils literal notranslate"><span class="pre">TrainableMetaModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#py0.metapop_model.TrainableMetaModel.call"><code class="docutils literal notranslate"><span class="pre">TrainableMetaModel.call()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#py0.metapop_model.TrainableMetaModel.compile"><code class="docutils literal notranslate"><span class="pre">TrainableMetaModel.compile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#py0.metapop_model.TrainableMetaModel.fit"><code class="docutils literal notranslate"><span class="pre">TrainableMetaModel.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#py0.metapop_model.TrainableMetaModel.get_traj"><code class="docutils literal notranslate"><span class="pre">TrainableMetaModel.get_traj()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.categorical_normal_layer"><code class="docutils literal notranslate"><span class="pre">categorical_normal_layer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.contact_infection_func"><code class="docutils literal notranslate"><span class="pre">contact_infection_func()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.negloglik"><code class="docutils literal notranslate"><span class="pre">negloglik()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.normal_mat_layer"><code class="docutils literal notranslate"><span class="pre">normal_mat_layer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.recip_norm_mat_dist"><code class="docutils literal notranslate"><span class="pre">recip_norm_mat_dist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.metapop_model.recip_norm_mat_layer"><code class="docutils literal notranslate"><span class="pre">recip_norm_mat_layer()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-py0.utils">utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.TransitionMatrix"><code class="docutils literal notranslate"><span class="pre">TransitionMatrix</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#py0.utils.TransitionMatrix.add_transition"><code class="docutils literal notranslate"><span class="pre">TransitionMatrix.add_transition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#py0.utils.TransitionMatrix.prior_matrix"><code class="docutils literal notranslate"><span class="pre">TransitionMatrix.prior_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#py0.utils.TransitionMatrix.value"><code class="docutils literal notranslate"><span class="pre">TransitionMatrix.value</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.compartment_restrainer"><code class="docutils literal notranslate"><span class="pre">compartment_restrainer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.draw_graph"><code class="docutils literal notranslate"><span class="pre">draw_graph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.draw_graph_on_map"><code class="docutils literal notranslate"><span class="pre">draw_graph_on_map()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.exposed_finder"><code class="docutils literal notranslate"><span class="pre">exposed_finder()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.gen_graph"><code class="docutils literal notranslate"><span class="pre">gen_graph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.gen_graph_from_R"><code class="docutils literal notranslate"><span class="pre">gen_graph_from_R()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.gen_random_graph"><code class="docutils literal notranslate"><span class="pre">gen_random_graph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.get_dist"><code class="docutils literal notranslate"><span class="pre">get_dist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.graph_degree"><code class="docutils literal notranslate"><span class="pre">graph_degree()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.merge_history"><code class="docutils literal notranslate"><span class="pre">merge_history()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.p0_loss"><code class="docutils literal notranslate"><span class="pre">p0_loss()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.p0_map"><code class="docutils literal notranslate"><span class="pre">p0_map()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.patch_quantile"><code class="docutils literal notranslate"><span class="pre">patch_quantile()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.plot_dist"><code class="docutils literal notranslate"><span class="pre">plot_dist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.sparse_graph_mobility"><code class="docutils literal notranslate"><span class="pre">sparse_graph_mobility()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.traj_loss"><code class="docutils literal notranslate"><span class="pre">traj_loss()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.traj_quantile"><code class="docutils literal notranslate"><span class="pre">traj_quantile()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.traj_to_restraints"><code class="docutils literal notranslate"><span class="pre">traj_to_restraints()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.weighted_exposed_prob_finder"><code class="docutils literal notranslate"><span class="pre">weighted_exposed_prob_finder()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py0.utils.weighted_quantile"><code class="docutils literal notranslate"><span class="pre">weighted_quantile()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="toc.html">py0</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="toc.html" class="icon icon-home"></a> &raquo;</li>
      <li>API</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ur-whitelab/py0" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="api">
<h1>API<a class="headerlink" href="#api" title="Permalink to this heading"></a></h1>
<section id="metapopulation-model">
<h2>metapopulation model<a class="headerlink" href="#metapopulation-model" title="Permalink to this heading"></a></h2>
<span class="target" id="module-py0.metapop_model"></span><dl class="py class">
<dt class="sig sig-object py" id="py0.metapop_model.AddSusceptibleLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">AddSusceptibleLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.AddSusceptibleLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="py0.metapop_model.AddSusceptibleLayer.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.AddSusceptibleLayer.call" title="Permalink to this definition"></a></dt>
<dd><p>This is where the layer’s logic lives.</p>
<p>Note here that <cite>call()</cite> method in <cite>tf.keras</cite> is little bit different
from <cite>keras</cite> API. In <cite>keras</cite> API, you can pass support masking for
layers as additional arguments. Whereas <cite>tf.keras</cite> has <cite>compute_mask()</cite>
method to support masking.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>inputs: Input tensor, or dict/list/tuple of input tensors.</dt><dd><p>The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul class="simple">
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite> only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</dd>
<dt><a href="#id1"><span class="problematic" id="id2">*</span></a>args: Additional positional arguments. May contain tensors, although</dt><dd><p>this is not recommended, for the reasons above.</p>
</dd>
<dt><a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs: Additional keyword arguments. May contain tensors, although</dt><dd><p>this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul class="simple">
<li><p><cite>mask</cite>: Boolean input mask. If the layer’s <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask generated
for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come from a layer
that generated a corresponding mask, i.e. if it came from a Keras
layer with masking support).</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="py0.metapop_model.ContactInfectionLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">ContactInfectionLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.ContactInfectionLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="py0.metapop_model.ContactInfectionLayer.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neff_compartments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neff</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.ContactInfectionLayer.call" title="Permalink to this definition"></a></dt>
<dd><p>This is where the layer’s logic lives.</p>
<p>Note here that <cite>call()</cite> method in <cite>tf.keras</cite> is little bit different
from <cite>keras</cite> API. In <cite>keras</cite> API, you can pass support masking for
layers as additional arguments. Whereas <cite>tf.keras</cite> has <cite>compute_mask()</cite>
method to support masking.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>inputs: Input tensor, or dict/list/tuple of input tensors.</dt><dd><p>The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul class="simple">
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite> only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</dd>
<dt><a href="#id5"><span class="problematic" id="id6">*</span></a>args: Additional positional arguments. May contain tensors, although</dt><dd><p>this is not recommended, for the reasons above.</p>
</dd>
<dt><a href="#id7"><span class="problematic" id="id8">**</span></a>kwargs: Additional keyword arguments. May contain tensors, although</dt><dd><p>this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul class="simple">
<li><p><cite>mask</cite>: Boolean input mask. If the layer’s <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask generated
for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come from a layer
that generated a corresponding mask, i.e. if it came from a Keras
layer with masking support).</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="py0.metapop_model.DeltaRegularizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">DeltaRegularizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.DeltaRegularizer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Regularizer</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="py0.metapop_model.MetaModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">MetaModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.MetaModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="py0.metapop_model.MetaModel.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.MetaModel.call" title="Permalink to this definition"></a></dt>
<dd><p>Calls the model on new inputs and returns the outputs as tensors.</p>
<p>In this case <cite>call()</cite> just reapplies
all ops in the graph to the new inputs
(e.g. build a new computational graph from the provided inputs).</p>
<p>Note: This method should not be called directly. It is only meant to be
overridden when subclassing <cite>tf.keras.Model</cite>.
To call a model on an input, always use the <cite>__call__()</cite> method,
i.e. <cite>model(inputs)</cite>, which relies on the underlying <cite>call()</cite> method.</p>
<dl>
<dt>Args:</dt><dd><p>inputs: Input tensor, or dict/list/tuple of input tensors.
training: Boolean or boolean scalar tensor, indicating whether to run</p>
<blockquote>
<div><p>the <cite>Network</cite> in training mode or inference mode.</p>
</div></blockquote>
<dl class="simple">
<dt>mask: A mask or list of masks. A mask can be either a boolean tensor or</dt><dd><dl class="simple">
<dt>None (no mask). For more details, check the guide</dt><dd><p>[here](<a class="reference external" href="https://www.tensorflow.org/guide/keras/masking_and_padding">https://www.tensorflow.org/guide/keras/masking_and_padding</a>).</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A tensor if there is a single output, or
a list of tensors if there are more than one outputs.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="py0.metapop_model.MetaParameterJoint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">MetaParameterJoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.MetaParameterJoint" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#py0.metapop_model.ParameterJoint" title="py0.metapop_model.ParameterJoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterJoint</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="py0.metapop_model.MetapopLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">MetapopLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.MetapopLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="py0.metapop_model.MetapopLayer.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.MetapopLayer.build" title="Permalink to this definition"></a></dt>
<dd><p>Creates the variables of the layer (optional, for subclass implementers).</p>
<p>This is a method that implementers of subclasses of <cite>Layer</cite> or <cite>Model</cite>
can override if they need a state-creation step in-between
layer instantiation and layer call.</p>
<p>This is typically used to create the weights of <cite>Layer</cite> subclasses.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>input_shape: Instance of <cite>TensorShape</cite>, or list of instances of</dt><dd><p><cite>TensorShape</cite> if the layer expects a list of inputs
(one instance per input).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="py0.metapop_model.MetapopLayer.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.MetapopLayer.call" title="Permalink to this definition"></a></dt>
<dd><p>This is where the layer’s logic lives.</p>
<p>Note here that <cite>call()</cite> method in <cite>tf.keras</cite> is little bit different
from <cite>keras</cite> API. In <cite>keras</cite> API, you can pass support masking for
layers as additional arguments. Whereas <cite>tf.keras</cite> has <cite>compute_mask()</cite>
method to support masking.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>inputs: Input tensor, or dict/list/tuple of input tensors.</dt><dd><p>The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul class="simple">
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite> only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</dd>
<dt><a href="#id9"><span class="problematic" id="id10">*</span></a>args: Additional positional arguments. May contain tensors, although</dt><dd><p>this is not recommended, for the reasons above.</p>
</dd>
<dt><a href="#id11"><span class="problematic" id="id12">**</span></a>kwargs: Additional keyword arguments. May contain tensors, although</dt><dd><p>this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul class="simple">
<li><p><cite>mask</cite>: Boolean input mask. If the layer’s <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask generated
for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come from a layer
that generated a corresponding mask, i.e. if it came from a Keras
layer with masking support).</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="py0.metapop_model.MinMaxConstraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">MinMaxConstraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.MinMaxConstraint" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></p>
<p>Makes weights normalized after reshape and applying mask</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="py0.metapop_model.NormalizationConstraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">NormalizationConstraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.NormalizationConstraint" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></p>
<p>Makes weights normalized after reshape and applying mask</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="py0.metapop_model.ParameterHypers">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">ParameterHypers</span></span><a class="headerlink" href="#py0.metapop_model.ParameterHypers" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="py0.metapop_model.ParameterJoint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">ParameterJoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.ParameterJoint" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="py0.metapop_model.ParameterJoint.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.ParameterJoint.compile" title="Permalink to this definition"></a></dt>
<dd><p>Configures the model for training.</p>
<p>Example:</p>
<p><a href="#id13"><span class="problematic" id="id14">``</span></a><a href="#id15"><span class="problematic" id="id16">`</span></a>python
model.compile(optimizer=tf.keras.optimizers.Adam(learning_rate=1e-3),</p>
<blockquote>
<div><p>loss=tf.keras.losses.BinaryCrossentropy(),
metrics=[tf.keras.metrics.BinaryAccuracy(),</p>
<blockquote>
<div><p>tf.keras.metrics.FalseNegatives()])</p>
</div></blockquote>
</div></blockquote>
<p><a href="#id17"><span class="problematic" id="id18">``</span></a><a href="#id19"><span class="problematic" id="id20">`</span></a></p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>optimizer: String (name of optimizer) or optimizer instance. See</dt><dd><p><cite>tf.keras.optimizers</cite>.</p>
</dd>
<dt>loss: Loss function. Maybe be a string (name of loss function), or</dt><dd><p>a <cite>tf.keras.losses.Loss</cite> instance. See <cite>tf.keras.losses</cite>. A loss
function is any callable with the signature <cite>loss = fn(y_true,
y_pred)</cite>, where <cite>y_true</cite> are the ground truth values, and
<cite>y_pred</cite> are the model’s predictions.
<cite>y_true</cite> should have shape
<cite>(batch_size, d0, .. dN)</cite> (except in the case of
sparse loss functions such as
sparse categorical crossentropy which expects integer arrays of shape
<cite>(batch_size, d0, .. dN-1)</cite>).
<cite>y_pred</cite> should have shape <cite>(batch_size, d0, .. dN)</cite>.
The loss function should return a float tensor.
If a custom <cite>Loss</cite> instance is
used and reduction is set to <cite>None</cite>, return value has shape
<cite>(batch_size, d0, .. dN-1)</cite> i.e. per-sample or per-timestep loss
values; otherwise, it is a scalar. If the model has multiple outputs,
you can use a different loss on each output by passing a dictionary
or a list of losses. The loss value that will be minimized by the
model will then be the sum of all individual losses, unless
<cite>loss_weights</cite> is specified.</p>
</dd>
<dt>metrics: List of metrics to be evaluated by the model during training</dt><dd><p>and testing. Each of this can be a string (name of a built-in
function), function or a <cite>tf.keras.metrics.Metric</cite> instance. See
<cite>tf.keras.metrics</cite>. Typically you will use <cite>metrics=[‘accuracy’]</cite>. A
function is any callable with the signature <cite>result = fn(y_true,
y_pred)</cite>. To specify different metrics for different outputs of a
multi-output model, you could also pass a dictionary, such as
<cite>metrics={‘output_a’: ‘accuracy’, ‘output_b’: [‘accuracy’, ‘mse’]}</cite>.
You can also pass a list to specify a metric or a list of metrics
for each output, such as <cite>metrics=[[‘accuracy’], [‘accuracy’, ‘mse’]]</cite>
or <cite>metrics=[‘accuracy’, [‘accuracy’, ‘mse’]]</cite>. When you pass the
strings ‘accuracy’ or ‘acc’, we convert this to one of
<cite>tf.keras.metrics.BinaryAccuracy</cite>,
<cite>tf.keras.metrics.CategoricalAccuracy</cite>,
<cite>tf.keras.metrics.SparseCategoricalAccuracy</cite> based on the loss
function used and the model output shape. We do a similar
conversion for the strings ‘crossentropy’ and ‘ce’ as well.</p>
</dd>
<dt>loss_weights: Optional list or dictionary specifying scalar coefficients</dt><dd><p>(Python floats) to weight the loss contributions of different model
outputs. The loss value that will be minimized by the model will then
be the <em>weighted sum</em> of all individual losses, weighted by the
<cite>loss_weights</cite> coefficients.</p>
<blockquote>
<div><dl class="simple">
<dt>If a list, it is expected to have a 1:1 mapping to the model’s</dt><dd><p>outputs. If a dict, it is expected to map output names (strings)
to scalar coefficients.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>weighted_metrics: List of metrics to be evaluated and weighted by</dt><dd><p><cite>sample_weight</cite> or <cite>class_weight</cite> during training and testing.</p>
</dd>
<dt>run_eagerly: Bool. Defaults to <cite>False</cite>. If <cite>True</cite>, this <cite>Model</cite>’s</dt><dd><p>logic will not be wrapped in a <cite>tf.function</cite>. Recommended to leave
this as <cite>None</cite> unless your <cite>Model</cite> cannot be run inside a
<cite>tf.function</cite>. <cite>run_eagerly=True</cite> is not supported when using
<cite>tf.distribute.experimental.ParameterServerStrategy</cite>.</p>
</dd>
<dt>steps_per_execution: Int. Defaults to 1. The number of batches to</dt><dd><p>run during each <cite>tf.function</cite> call. Running multiple batches
inside a single <cite>tf.function</cite> call can greatly improve performance
on TPUs or small models with a large Python overhead.
At most, one full epoch will be run each
execution. If a number larger than the size of the epoch is passed,
the execution will be truncated to the size of the epoch.
Note that if <cite>steps_per_execution</cite> is set to <cite>N</cite>,
<cite>Callback.on_batch_begin</cite> and <cite>Callback.on_batch_end</cite> methods
will only be called every <cite>N</cite> batches
(i.e. before/after each <cite>tf.function</cite> execution).</p>
</dd>
</dl>
<p><a href="#id21"><span class="problematic" id="id22">**</span></a>kwargs: Arguments supported for backwards compatibility only.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="py0.metapop_model.ParameterJoint.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_joint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.ParameterJoint.sample" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="py0.metapop_model.PositiveMaskedConstraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">PositiveMaskedConstraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.PositiveMaskedConstraint" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></p>
<p>Makes weights normalized after reshape and applying mask</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="py0.metapop_model.TrainableInputLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">TrainableInputLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.TrainableInputLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Create trainable input layer</p>
<dl class="py method">
<dt class="sig sig-object py" id="py0.metapop_model.TrainableInputLayer.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.TrainableInputLayer.call" title="Permalink to this definition"></a></dt>
<dd><p>This is where the layer’s logic lives.</p>
<p>Note here that <cite>call()</cite> method in <cite>tf.keras</cite> is little bit different
from <cite>keras</cite> API. In <cite>keras</cite> API, you can pass support masking for
layers as additional arguments. Whereas <cite>tf.keras</cite> has <cite>compute_mask()</cite>
method to support masking.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>inputs: Input tensor, or dict/list/tuple of input tensors.</dt><dd><p>The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul class="simple">
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite> only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</dd>
<dt><a href="#id23"><span class="problematic" id="id24">*</span></a>args: Additional positional arguments. May contain tensors, although</dt><dd><p>this is not recommended, for the reasons above.</p>
</dd>
<dt><a href="#id25"><span class="problematic" id="id26">**</span></a>kwargs: Additional keyword arguments. May contain tensors, although</dt><dd><p>this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul class="simple">
<li><p><cite>mask</cite>: Boolean input mask. If the layer’s <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask generated
for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come from a layer
that generated a corresponding mask, i.e. if it came from a Keras
layer with masking support).</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="py0.metapop_model.TrainableMetaModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">TrainableMetaModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.TrainableMetaModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="py0.metapop_model.TrainableMetaModel.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.TrainableMetaModel.call" title="Permalink to this definition"></a></dt>
<dd><p>Calls the model on new inputs and returns the outputs as tensors.</p>
<p>In this case <cite>call()</cite> just reapplies
all ops in the graph to the new inputs
(e.g. build a new computational graph from the provided inputs).</p>
<p>Note: This method should not be called directly. It is only meant to be
overridden when subclassing <cite>tf.keras.Model</cite>.
To call a model on an input, always use the <cite>__call__()</cite> method,
i.e. <cite>model(inputs)</cite>, which relies on the underlying <cite>call()</cite> method.</p>
<dl>
<dt>Args:</dt><dd><p>inputs: Input tensor, or dict/list/tuple of input tensors.
training: Boolean or boolean scalar tensor, indicating whether to run</p>
<blockquote>
<div><p>the <cite>Network</cite> in training mode or inference mode.</p>
</div></blockquote>
<dl class="simple">
<dt>mask: A mask or list of masks. A mask can be either a boolean tensor or</dt><dd><dl class="simple">
<dt>None (no mask). For more details, check the guide</dt><dd><p>[here](<a class="reference external" href="https://www.tensorflow.org/guide/keras/masking_and_padding">https://www.tensorflow.org/guide/keras/masking_and_padding</a>).</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A tensor if there is a single output, or
a list of tensors if there are more than one outputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="py0.metapop_model.TrainableMetaModel.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.TrainableMetaModel.compile" title="Permalink to this definition"></a></dt>
<dd><p>Configures the model for training.</p>
<p>Example:</p>
<p><a href="#id27"><span class="problematic" id="id28">``</span></a><a href="#id29"><span class="problematic" id="id30">`</span></a>python
model.compile(optimizer=tf.keras.optimizers.Adam(learning_rate=1e-3),</p>
<blockquote>
<div><p>loss=tf.keras.losses.BinaryCrossentropy(),
metrics=[tf.keras.metrics.BinaryAccuracy(),</p>
<blockquote>
<div><p>tf.keras.metrics.FalseNegatives()])</p>
</div></blockquote>
</div></blockquote>
<p><a href="#id31"><span class="problematic" id="id32">``</span></a><a href="#id33"><span class="problematic" id="id34">`</span></a></p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>optimizer: String (name of optimizer) or optimizer instance. See</dt><dd><p><cite>tf.keras.optimizers</cite>.</p>
</dd>
<dt>loss: Loss function. Maybe be a string (name of loss function), or</dt><dd><p>a <cite>tf.keras.losses.Loss</cite> instance. See <cite>tf.keras.losses</cite>. A loss
function is any callable with the signature <cite>loss = fn(y_true,
y_pred)</cite>, where <cite>y_true</cite> are the ground truth values, and
<cite>y_pred</cite> are the model’s predictions.
<cite>y_true</cite> should have shape
<cite>(batch_size, d0, .. dN)</cite> (except in the case of
sparse loss functions such as
sparse categorical crossentropy which expects integer arrays of shape
<cite>(batch_size, d0, .. dN-1)</cite>).
<cite>y_pred</cite> should have shape <cite>(batch_size, d0, .. dN)</cite>.
The loss function should return a float tensor.
If a custom <cite>Loss</cite> instance is
used and reduction is set to <cite>None</cite>, return value has shape
<cite>(batch_size, d0, .. dN-1)</cite> i.e. per-sample or per-timestep loss
values; otherwise, it is a scalar. If the model has multiple outputs,
you can use a different loss on each output by passing a dictionary
or a list of losses. The loss value that will be minimized by the
model will then be the sum of all individual losses, unless
<cite>loss_weights</cite> is specified.</p>
</dd>
<dt>metrics: List of metrics to be evaluated by the model during training</dt><dd><p>and testing. Each of this can be a string (name of a built-in
function), function or a <cite>tf.keras.metrics.Metric</cite> instance. See
<cite>tf.keras.metrics</cite>. Typically you will use <cite>metrics=[‘accuracy’]</cite>. A
function is any callable with the signature <cite>result = fn(y_true,
y_pred)</cite>. To specify different metrics for different outputs of a
multi-output model, you could also pass a dictionary, such as
<cite>metrics={‘output_a’: ‘accuracy’, ‘output_b’: [‘accuracy’, ‘mse’]}</cite>.
You can also pass a list to specify a metric or a list of metrics
for each output, such as <cite>metrics=[[‘accuracy’], [‘accuracy’, ‘mse’]]</cite>
or <cite>metrics=[‘accuracy’, [‘accuracy’, ‘mse’]]</cite>. When you pass the
strings ‘accuracy’ or ‘acc’, we convert this to one of
<cite>tf.keras.metrics.BinaryAccuracy</cite>,
<cite>tf.keras.metrics.CategoricalAccuracy</cite>,
<cite>tf.keras.metrics.SparseCategoricalAccuracy</cite> based on the loss
function used and the model output shape. We do a similar
conversion for the strings ‘crossentropy’ and ‘ce’ as well.</p>
</dd>
<dt>loss_weights: Optional list or dictionary specifying scalar coefficients</dt><dd><p>(Python floats) to weight the loss contributions of different model
outputs. The loss value that will be minimized by the model will then
be the <em>weighted sum</em> of all individual losses, weighted by the
<cite>loss_weights</cite> coefficients.</p>
<blockquote>
<div><dl class="simple">
<dt>If a list, it is expected to have a 1:1 mapping to the model’s</dt><dd><p>outputs. If a dict, it is expected to map output names (strings)
to scalar coefficients.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>weighted_metrics: List of metrics to be evaluated and weighted by</dt><dd><p><cite>sample_weight</cite> or <cite>class_weight</cite> during training and testing.</p>
</dd>
<dt>run_eagerly: Bool. Defaults to <cite>False</cite>. If <cite>True</cite>, this <cite>Model</cite>’s</dt><dd><p>logic will not be wrapped in a <cite>tf.function</cite>. Recommended to leave
this as <cite>None</cite> unless your <cite>Model</cite> cannot be run inside a
<cite>tf.function</cite>. <cite>run_eagerly=True</cite> is not supported when using
<cite>tf.distribute.experimental.ParameterServerStrategy</cite>.</p>
</dd>
<dt>steps_per_execution: Int. Defaults to 1. The number of batches to</dt><dd><p>run during each <cite>tf.function</cite> call. Running multiple batches
inside a single <cite>tf.function</cite> call can greatly improve performance
on TPUs or small models with a large Python overhead.
At most, one full epoch will be run each
execution. If a number larger than the size of the epoch is passed,
the execution will be truncated to the size of the epoch.
Note that if <cite>steps_per_execution</cite> is set to <cite>N</cite>,
<cite>Callback.on_batch_begin</cite> and <cite>Callback.on_batch_end</cite> methods
will only be called every <cite>N</cite> batches
(i.e. before/after each <cite>tf.function</cite> execution).</p>
</dd>
</dl>
<p><a href="#id35"><span class="problematic" id="id36">**</span></a>kwargs: Arguments supported for backwards compatibility only.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="py0.metapop_model.TrainableMetaModel.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.TrainableMetaModel.fit" title="Permalink to this definition"></a></dt>
<dd><p>Trains the model for a fixed number of epochs (iterations on a dataset).</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>x: Input data. It could be:</dt><dd><ul class="simple">
<li><p>A Numpy array (or array-like), or a list of arrays
(in case the model has multiple inputs).</p></li>
<li><p>A TensorFlow tensor, or a list of tensors
(in case the model has multiple inputs).</p></li>
<li><p>A dict mapping input names to the corresponding array/tensors,
if the model has named inputs.</p></li>
<li><p>A <cite>tf.data</cite> dataset. Should return a tuple
of either <cite>(inputs, targets)</cite> or
<cite>(inputs, targets, sample_weights)</cite>.</p></li>
<li><p>A generator or <cite>keras.utils.Sequence</cite> returning <cite>(inputs, targets)</cite>
or <cite>(inputs, targets, sample_weights)</cite>.</p></li>
<li><p>A <cite>tf.keras.utils.experimental.DatasetCreator</cite>, which wraps a
callable that takes a single argument of type
<cite>tf.distribute.InputContext</cite>, and returns a <cite>tf.data.Dataset</cite>.
<cite>DatasetCreator</cite> should be used when users prefer to specify the
per-replica batching and sharding logic for the <cite>Dataset</cite>.
See <cite>tf.keras.utils.experimental.DatasetCreator</cite> doc for more
information.</p></li>
</ul>
<p>A more detailed description of unpacking behavior for iterator types
(Dataset, generator, Sequence) is given below. If using
<cite>tf.distribute.experimental.ParameterServerStrategy</cite>, only
<cite>DatasetCreator</cite> type is supported for <cite>x</cite>.</p>
</dd>
<dt>y: Target data. Like the input data <cite>x</cite>,</dt><dd><p>it could be either Numpy array(s) or TensorFlow tensor(s).
It should be consistent with <cite>x</cite> (you cannot have Numpy inputs and
tensor targets, or inversely). If <cite>x</cite> is a dataset, generator,
or <cite>keras.utils.Sequence</cite> instance, <cite>y</cite> should
not be specified (since targets will be obtained from <cite>x</cite>).</p>
</dd>
<dt>batch_size: Integer or <cite>None</cite>.</dt><dd><p>Number of samples per gradient update.
If unspecified, <cite>batch_size</cite> will default to 32.
Do not specify the <cite>batch_size</cite> if your data is in the
form of datasets, generators, or <cite>keras.utils.Sequence</cite> instances
(since they generate batches).</p>
</dd>
<dt>epochs: Integer. Number of epochs to train the model.</dt><dd><p>An epoch is an iteration over the entire <cite>x</cite> and <cite>y</cite>
data provided
(unless the <cite>steps_per_epoch</cite> flag is set to
something other than None).
Note that in conjunction with <cite>initial_epoch</cite>,
<cite>epochs</cite> is to be understood as “final epoch”.
The model is not trained for a number of iterations
given by <cite>epochs</cite>, but merely until the epoch
of index <cite>epochs</cite> is reached.</p>
</dd>
<dt>verbose: ‘auto’, 0, 1, or 2. Verbosity mode.</dt><dd><p>0 = silent, 1 = progress bar, 2 = one line per epoch.
‘auto’ defaults to 1 for most cases, but 2 when used with
<cite>ParameterServerStrategy</cite>. Note that the progress bar is not
particularly useful when logged to a file, so verbose=2 is
recommended when not running interactively (eg, in a production
environment).</p>
</dd>
<dt>callbacks: List of <cite>keras.callbacks.Callback</cite> instances.</dt><dd><p>List of callbacks to apply during training.
See <cite>tf.keras.callbacks</cite>. Note <cite>tf.keras.callbacks.ProgbarLogger</cite>
and <cite>tf.keras.callbacks.History</cite> callbacks are created automatically
and need not be passed into <cite>model.fit</cite>.
<cite>tf.keras.callbacks.ProgbarLogger</cite> is created or not based on
<cite>verbose</cite> argument to <cite>model.fit</cite>.
Callbacks with batch-level calls are currently unsupported with
<cite>tf.distribute.experimental.ParameterServerStrategy</cite>, and users are
advised to implement epoch-level calls instead with an appropriate
<cite>steps_per_epoch</cite> value.</p>
</dd>
<dt>validation_split: Float between 0 and 1.</dt><dd><blockquote>
<div><p>Fraction of the training data to be used as validation data.
The model will set apart this fraction of the training data,
will not train on it, and will evaluate
the loss and any model metrics
on this data at the end of each epoch.
The validation data is selected from the last samples
in the <cite>x</cite> and <cite>y</cite> data provided, before shuffling. This argument is
not supported when <cite>x</cite> is a dataset, generator or</p>
</div></blockquote>
<dl class="simple">
<dt><cite>keras.utils.Sequence</cite> instance.</dt><dd><p><cite>validation_split</cite> is not yet supported with
<cite>tf.distribute.experimental.ParameterServerStrategy</cite>.</p>
</dd>
</dl>
</dd>
<dt>validation_data: Data on which to evaluate</dt><dd><p>the loss and any model metrics at the end of each epoch.
The model will not be trained on this data. Thus, note the fact
that the validation loss of data provided using <cite>validation_split</cite>
or <cite>validation_data</cite> is not affected by regularization layers like
noise and dropout.
<cite>validation_data</cite> will override <cite>validation_split</cite>.
<cite>validation_data</cite> could be:</p>
<blockquote>
<div><ul class="simple">
<li><p>A tuple <cite>(x_val, y_val)</cite> of Numpy arrays or tensors.</p></li>
<li><p>A tuple <cite>(x_val, y_val, val_sample_weights)</cite> of NumPy arrays.</p></li>
<li><p>A <cite>tf.data.Dataset</cite>.</p></li>
<li><p>A Python generator or <cite>keras.utils.Sequence</cite> returning</p></li>
</ul>
<p><cite>(inputs, targets)</cite> or <cite>(inputs, targets, sample_weights)</cite>.</p>
</div></blockquote>
<p><cite>validation_data</cite> is not yet supported with
<cite>tf.distribute.experimental.ParameterServerStrategy</cite>.</p>
</dd>
<dt>shuffle: Boolean (whether to shuffle the training data</dt><dd><p>before each epoch) or str (for ‘batch’). This argument is ignored
when <cite>x</cite> is a generator or an object of tf.data.Dataset.
‘batch’ is a special option for dealing
with the limitations of HDF5 data; it shuffles in batch-sized
chunks. Has no effect when <cite>steps_per_epoch</cite> is not <cite>None</cite>.</p>
</dd>
<dt>class_weight: Optional dictionary mapping class indices (integers)</dt><dd><p>to a weight (float) value, used for weighting the loss function
(during training only).
This can be useful to tell the model to
“pay more attention” to samples from
an under-represented class.</p>
</dd>
<dt>sample_weight: Optional Numpy array of weights for</dt><dd><blockquote>
<div><p>the training samples, used for weighting the loss function
(during training only). You can either pass a flat (1D)
Numpy array with the same length as the input samples
(1:1 mapping between weights and samples),
or in the case of temporal data,
you can pass a 2D array with shape
<cite>(samples, sequence_length)</cite>,
to apply a different weight to every timestep of every sample. This
argument is not supported when <cite>x</cite> is a dataset, generator, or</p>
</div></blockquote>
<dl class="simple">
<dt><cite>keras.utils.Sequence</cite> instance, instead provide the sample_weights</dt><dd><p>as the third element of <cite>x</cite>.</p>
</dd>
</dl>
</dd>
<dt>initial_epoch: Integer.</dt><dd><p>Epoch at which to start training
(useful for resuming a previous training run).</p>
</dd>
<dt>steps_per_epoch: Integer or <cite>None</cite>.</dt><dd><p>Total number of steps (batches of samples)
before declaring one epoch finished and starting the
next epoch. When training with input tensors such as
TensorFlow data tensors, the default <cite>None</cite> is equal to
the number of samples in your dataset divided by
the batch size, or 1 if that cannot be determined. If x is a
<cite>tf.data</cite> dataset, and ‘steps_per_epoch’
is None, the epoch will run until the input dataset is exhausted.
When passing an infinitely repeating dataset, you must specify the
<cite>steps_per_epoch</cite> argument. If <cite>steps_per_epoch=-1</cite> the training
will run indefinitely with an infinitely repeating dataset.
This argument is not supported with array inputs.
When using <cite>tf.distribute.experimental.ParameterServerStrategy</cite>:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>steps_per_epoch=None</cite> is not supported.</p></li>
</ul>
</div></blockquote>
</dd>
<dt>validation_steps: Only relevant if <cite>validation_data</cite> is provided and</dt><dd><p>is a <cite>tf.data</cite> dataset. Total number of steps (batches of
samples) to draw before stopping when performing validation
at the end of every epoch. If ‘validation_steps’ is None, validation
will run until the <cite>validation_data</cite> dataset is exhausted. In the
case of an infinitely repeated dataset, it will run into an
infinite loop. If ‘validation_steps’ is specified and only part of
the dataset will be consumed, the evaluation will start from the
beginning of the dataset at each epoch. This ensures that the same
validation samples are used every time.</p>
</dd>
<dt>validation_batch_size: Integer or <cite>None</cite>.</dt><dd><p>Number of samples per validation batch.
If unspecified, will default to <cite>batch_size</cite>.
Do not specify the <cite>validation_batch_size</cite> if your data is in the
form of datasets, generators, or <cite>keras.utils.Sequence</cite> instances
(since they generate batches).</p>
</dd>
<dt>validation_freq: Only relevant if validation data is provided. Integer</dt><dd><p>or <cite>collections.abc.Container</cite> instance (e.g. list, tuple, etc.).
If an integer, specifies how many training epochs to run before a
new validation run is performed, e.g. <cite>validation_freq=2</cite> runs
validation every 2 epochs. If a Container, specifies the epochs on
which to run validation, e.g. <cite>validation_freq=[1, 2, 10]</cite> runs
validation at the end of the 1st, 2nd, and 10th epochs.</p>
</dd>
<dt>max_queue_size: Integer. Used for generator or <cite>keras.utils.Sequence</cite></dt><dd><p>input only. Maximum size for the generator queue.
If unspecified, <cite>max_queue_size</cite> will default to 10.</p>
</dd>
<dt>workers: Integer. Used for generator or <cite>keras.utils.Sequence</cite> input</dt><dd><p>only. Maximum number of processes to spin up
when using process-based threading. If unspecified, <cite>workers</cite>
will default to 1.</p>
</dd>
<dt>use_multiprocessing: Boolean. Used for generator or</dt><dd><p><cite>keras.utils.Sequence</cite> input only. If <cite>True</cite>, use process-based
threading. If unspecified, <cite>use_multiprocessing</cite> will default to
<cite>False</cite>. Note that because this implementation relies on
multiprocessing, you should not pass non-picklable arguments to
the generator as they can’t be passed easily to children processes.</p>
</dd>
</dl>
</dd>
<dt>Unpacking behavior for iterator-like inputs:</dt><dd><blockquote>
<div><p>A common pattern is to pass a tf.data.Dataset, generator, or</p>
</div></blockquote>
<p>tf.keras.utils.Sequence to the <cite>x</cite> argument of fit, which will in fact
yield not only features (x) but optionally targets (y) and sample weights.
Keras requires that the output of such iterator-likes be unambiguous. The
iterator should return a tuple of length 1, 2, or 3, where the optional
second and third elements will be used for y and sample_weight
respectively. Any other type provided will be wrapped in a length one
tuple, effectively treating everything as ‘x’. When yielding dicts, they
should still adhere to the top-level tuple structure.
e.g. <cite>({“x0”: x0, “x1”: x1}, y)</cite>. Keras will not attempt to separate
features, targets, and weights from the keys of a single dict.</p>
<blockquote>
<div><p>A notable unsupported data type is the namedtuple. The reason is that</p>
</div></blockquote>
<p>it behaves like both an ordered datatype (tuple) and a mapping
datatype (dict). So given a namedtuple of the form:</p>
<blockquote>
<div><p><cite>namedtuple(“example_tuple”, [“y”, “x”])</cite></p>
</div></blockquote>
<p>it is ambiguous whether to reverse the order of the elements when
interpreting the value. Even worse is a tuple of the form:</p>
<blockquote>
<div><p><cite>namedtuple(“other_tuple”, [“x”, “y”, “z”])</cite></p>
</div></blockquote>
<p>where it is unclear if the tuple was intended to be unpacked into x, y,
and sample_weight or passed through as a single element to <cite>x</cite>. As a
result the data processing code will simply raise a ValueError if it
encounters a namedtuple. (Along with instructions to remedy the issue.)</p>
</dd>
<dt>Returns:</dt><dd><p>A <cite>History</cite> object. Its <cite>History.history</cite> attribute is
a record of training loss values and metrics values
at successive epochs, as well as validation loss values
and validation metrics values (if applicable).</p>
</dd>
<dt>Raises:</dt><dd><p>RuntimeError: 1. If the model was never compiled or,
2. If <cite>model.fit</cite> is  wrapped in <cite>tf.function</cite>.</p>
<dl class="simple">
<dt>ValueError: In case of mismatch between the provided input data</dt><dd><p>and what the model expects or when the input data is empty.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="py0.metapop_model.TrainableMetaModel.get_traj">
<span class="sig-name descname"><span class="pre">get_traj</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.TrainableMetaModel.get_traj" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.metapop_model.categorical_normal_layer">
<span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">categorical_normal_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_logits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.categorical_normal_layer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.metapop_model.contact_infection_func">
<span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">contact_infection_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infectious_compartments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">tf.float64</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.contact_infection_func" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.metapop_model.negloglik">
<span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">negloglik</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rv_y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.negloglik" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.metapop_model.normal_mat_layer">
<span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">normal_mat_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000000000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.normal_mat_layer" title="Permalink to this definition"></a></dt>
<dd><p>Normally distributed trainable distribution. Zeros in mobility matrix are preserved.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.metapop_model.recip_norm_mat_dist">
<span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">recip_norm_mat_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trans_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans_times_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.recip_norm_mat_dist" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.metapop_model.recip_norm_mat_layer">
<span class="sig-prename descclassname"><span class="pre">py0.metapop_model.</span></span><span class="sig-name descname"><span class="pre">recip_norm_mat_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_means</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_infectious_compartments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.metapop_model.recip_norm_mat_layer" title="Permalink to this definition"></a></dt>
<dd><p>Column Normalized Reciprical Gaussian trainable distribution. Zeros in starting matrix are preserved.</p>
</dd></dl>

</section>
<section id="module-py0.utils">
<span id="utilities"></span><h2>utilities<a class="headerlink" href="#module-py0.utils" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="py0.utils.TransitionMatrix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">TransitionMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compartment_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infectious_compartments</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.TransitionMatrix" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Defines the transition between different compartments in the disease model, given different epidemiology parameters.</p>
<dl class="py method">
<dt class="sig sig-object py" id="py0.utils.TransitionMatrix.add_transition">
<span class="sig-name descname"><span class="pre">add_transition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_var</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.TransitionMatrix.add_transition" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name1</strong> (<em>string</em>) – source compartment</p></li>
<li><p><strong>name2</strong> (<em>string</em>) – destination compartment</p></li>
<li><p><strong>time</strong> (<em>float</em>) – time it takes to move from source compartment to destination compartment. This is typically the reciprocal of rates.</p></li>
<li><p><strong>time_var</strong> (<em>float</em>) – variance of the time it takes to move from source compartment to destination compartment. Use zero unless you are
creating an esemble of trajectories to do inference using MaxEnt.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="py0.utils.TransitionMatrix.prior_matrix">
<span class="sig-name descname"><span class="pre">prior_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.TransitionMatrix.prior_matrix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="py0.utils.TransitionMatrix.value">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#py0.utils.TransitionMatrix.value" title="Permalink to this definition"></a></dt>
<dd><p>Returns matrix value.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.compartment_restrainer">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">compartment_restrainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">restrained_patches</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrained_compartments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_traj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.compartment_restrainer" title="Permalink to this definition"></a></dt>
<dd><p>Adds restraints to reference traj based on selected compartments of selected patches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>restrained_patches</strong> (<em>list</em>) – index of the patches (nodes) restrained</p></li>
<li><p><strong>restrained_compartments</strong> (<em>list</em>) – index values for the restrained compartments</p></li>
<li><p><strong>ref_traj</strong> (<em>a</em><em> [</em><em>1</em><em>, </em><em>T</em><em>, </em><em>M</em><em>, </em><em>C</em><em>] </em><em>tensor with dtype tf.float32</em><em>, </em><em>where T is the number</em><em> of </em><em>timesteps</em><em>, </em><em>M is the number</em><em> of </em><em>patches</em><em> (</em><em>nodes</em><em>) </em><em>and
C is the number</em><em> of </em><em>compartments.</em>) – reference traj</p></li>
<li><p><strong>prior</strong> (<em>maxent.prior</em>) – Prior distribution for expected deviation from target for restraint. Can be either ‘EmptyPrior’ for exact agreement
or set to ‘Laplace’ for more allowable disagreement.</p></li>
<li><p><strong>npoints</strong> (<em>int</em>) – number of data points in each restrained compartment</p></li>
<li><p><strong>noise</strong> (<em>float</em>) – multiplicative noise to be added to observations to allow higher uncertainty</p></li>
<li><p><strong>start_time</strong> (<em>int</em>) – index for the lower time limit of restraints</p></li>
<li><p><strong>end_time</strong> (<em>int</em>) – index for the higher time limit of restraints. If not provided, maximum timestep will be assumed.</p></li>
<li><p><strong>time_average</strong> (<em>int</em>) – number of timesteps to for time averaging of restraints</p></li>
<li><p><strong>marker_size</strong> (<em>int</em>) – marker size for restraints</p></li>
<li><p><strong>marker_color</strong> (<em>string</em>) – marker color for restraints</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>restraints, plot_fxns_list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.draw_graph">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">draw_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heatmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_origin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.draw_graph" title="Permalink to this definition"></a></dt>
<dd><p>Plots networkx graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – networkx graph</p></li>
<li><p><strong>weights</strong> – probabiity of being exposed in every patch at time zero across all the sample trajs. If not provided uniform
probability will be assumed over all nodes.</p></li>
<li><p><strong>heatmap</strong> (<em>bool</em>) – change node color based on weights</p></li>
<li><p><strong>title</strong> (<em>string</em>) – plot title</p></li>
<li><p><strong>dpi</strong> (<em>int</em>) – dpi value of plot</p></li>
<li><p><strong>true_origin</strong> (<em>int</em>) – index for the true origin node</p></li>
<li><p><strong>color_bar</strong> (<em>bool</em>) – enables color bar in plot</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.draw_graph_on_map">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">draw_graph_on_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mobility_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geojson</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#eb4034'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#555555'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_face_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_edge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_origin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrained_patches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C8'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_map_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.draw_graph_on_map" title="Permalink to this definition"></a></dt>
<dd><p>Plots networkx graph on a map given mobility flows and geographic features. The edges are weighted by the mobility flows between the nodes.
This function also alows for visualization of true orgin node and observed ones.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mobility_matrix</strong> (<em>numpy array</em><em> of </em><em>[</em><em>M</em><em>, </em><em>M</em><em>]</em><em>, </em><em>where M is the number</em><em> of </em><em>nodes in the metapopulation</em>) – mobility flows between the nodes</p></li>
<li><p><strong>geojson</strong> (<em>string</em>) – path to GeoJSON file describing the geographic features of the metapopulation</p></li>
<li><p><strong>title</strong> (<em>string</em>) – figure title</p></li>
<li><p><strong>node_size</strong> (<em>int</em>) – size for the networkx nodes</p></li>
<li><p><strong>node_color</strong> (<em>string</em><em> or </em><em>a list</em><em> of </em><em>strings with length M</em>) – color for the networkx nodes</p></li>
<li><p><strong>edge_color</strong> (<em>string</em>) – color for the networkx edges</p></li>
<li><p><strong>map_face_colors</strong> (<em>string</em><em> or </em><em>a list</em><em> of </em><em>strings with length M</em>) – color for the faces of patches on the map</p></li>
<li><p><strong>fontsize</strong> (<em>float</em>) – font size</p></li>
<li><p><strong>figsize</strong> (<em>tupple</em>) – figure size</p></li>
<li><p><strong>ax</strong> – <code class="docutils literal notranslate"><span class="pre">matplotlib.axes.AxesSubplot</span></code>. Defaults to a new axis.</p></li>
<li><p><strong>show_legend</strong> (<em>bool</em>) – show legend for true origin or obsevations.</p></li>
<li><p><strong>alpha_edge</strong> (<em>float</em>) – alpha value for edges that allows transparency</p></li>
<li><p><strong>alpha_nodes</strong> (<em>float</em>) – alpha value for nodes that allows transparency</p></li>
<li><p><strong>true_origin</strong> (<em>int</em>) – index for the true origin node</p></li>
<li><p><strong>restrained_patches</strong> (<em>list</em>) – index of the patches (nodes) restrained</p></li>
<li><p><strong>obs_color</strong> (<em>string</em>) – marker color for the observation nodes</p></li>
<li><p><strong>org_color</strong> (<em>tensor with dtype tf.float32</em>) – marker size for the true origin node</p></li>
<li><p><strong>show_map_only</strong> (<em>bool</em>) – Showing the map only without the networkx graph. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.exposed_finder">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">exposed_finder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.exposed_finder" title="Permalink to this definition"></a></dt>
<dd><p>Finds the initial exposed patch (t=0) for trajs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>trajs</strong> (<em>tensor with dtype tf.float32</em><em> of </em><em>shape</em><em> [</em><em>N</em><em>, </em><em>T</em><em>, </em><em>M</em><em>, </em><em>C</em><em>] </em><em>where N is the number</em><em> of </em><em>samples</em><em>, </em><em>T is the number</em><em> of </em><em>timesteps</em><em>,
</em><em>M is the number</em><em> of </em><em>patches</em><em> (</em><em>nodes</em><em>) </em><em>and C is the number</em><em> of </em><em>compartments.</em>) – ensemble of trajectories after sampling</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array containing the index of the initial exposed node for the ensemble of trajectories</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.gen_graph">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">gen_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.gen_graph" title="Permalink to this definition"></a></dt>
<dd><p>Generates a fully connected dense networkx graph of size M, edge list and node list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>M</strong> (<em>int</em>) – number of nodes in the metapopulation</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>graph, edge list, node list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.gen_graph_from_R">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">gen_graph_from_R</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mobility_matrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.gen_graph_from_R" title="Permalink to this definition"></a></dt>
<dd><p>Generates a networkx graph of size mobility_matrix.shape[0], edge list and node list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mobility_matrix</strong> (<em>numpy array</em><em> of </em><em>[</em><em>M</em><em>, </em><em>M</em><em>]</em><em>, </em><em>where M is the number</em><em> of </em><em>nodes in the metapopulation</em>) – mobility flows between the nodes</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>graph, edge list, node list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.gen_random_graph">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">gen_random_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.gen_random_graph" title="Permalink to this definition"></a></dt>
<dd><p>Returns a random networkx graph of size M with connection probability p</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>int</em>) – number of nodes in the metapopulation</p></li>
<li><p><strong>p</strong> (<em>float</em>) – node connection probability</p></li>
<li><p><strong>seed</strong> – allows random seeding for graph generations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>graph</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.get_dist">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">get_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prior_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compartments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['E',</span> <span class="pre">'A',</span> <span class="pre">'I',</span> <span class="pre">'R']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.get_dist" title="Permalink to this definition"></a></dt>
<dd><p>Gets distributions for the model parameters in the ensemble trectory sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prior_params</strong> (<em>list</em>) – model parameters during sampling over different batches.</p></li>
<li><p><strong>compartments</strong> (<em>list</em>) – list of compartments except for ‘S’ (susceptible) as strings.</p></li>
</ul>
</dd>
</dl>
<p>return: list of model parameter’s distributions.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.graph_degree">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">graph_degree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.graph_degree" title="Permalink to this definition"></a></dt>
<dd><p>Returns graph degree of a network graph based on networkx graph input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>graph</strong> – networkx graph</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>graph degree</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.merge_history">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">merge_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.merge_history" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.p0_loss">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">p0_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_origin</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.p0_loss" title="Permalink to this definition"></a></dt>
<dd><p>Returns cross-entropy loss for p0 based on sampled trajs and maxent weights, size of meta-population and ground-truth p0 node inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajs</strong> (<em>a</em><em> [</em><em>N</em><em>, </em><em>T</em><em>, </em><em>M</em><em>, </em><em>C</em><em>] </em><em>tensor with dtype tf.float32</em><em>, </em><em>where N is the number</em><em> of </em><em>samples</em><em>, </em><em>T is the number</em><em> of </em><em>timesteps</em><em>,
</em><em>M is the number</em><em> of </em><em>patches</em><em> (</em><em>nodes</em><em>) </em><em>and C is the number</em><em> of </em><em>compartments</em>) – sampled ensemble of trajectories</p></li>
<li><p><strong>weights</strong> (<em>tensor with dtype tf.float32</em>) – weights of the trajectories in the ensemble. If not provided, will be assumed as 1/N.</p></li>
<li><p><strong>true_origin</strong> (<em>int</em>) – index for the true origin node</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cross-entropy loss</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.p0_map">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">p0_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prior_exposed_patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_pop_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">choropleth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geojson</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(15,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrained_patches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_origin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C8'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Reds'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.p0_map" title="Permalink to this definition"></a></dt>
<dd><p>Plots the weighted probabiity of being exposed in every patch at time zero on a grid or
on a choropleth map (this requires geopandas and geoplot packages). If choropleth plotting is enabled, make sure your geojson has ‘county’ as header for 
the counties name column and your patches names are alphabetically sorted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prior_exposed_patch</strong> (<em>an array</em><em> of </em><em>size N</em><em> (</em><em>sample size</em><em>)</em>) – output of <code class="docutils literal notranslate"><span class="pre">exposed_finder</span></code> function.</p></li>
<li><p><strong>meta_pop_size</strong> (<em>int</em>) – size of the metapopulation</p></li>
<li><p><strong>weights</strong> (<em>tensor with dtype tf.float32</em>) – weights of the trajectories in the ensemble. If not provided, will be assumed as 1/N.</p></li>
<li><p><strong>patch_names</strong> (<em>list</em>) – name of the patches. Note that the namings should be similar to names from GeoJSON if using <code class="docutils literal notranslate"><span class="pre">choropleth</span></code>.</p></li>
<li><p><strong>title</strong> (<em>string</em>) – figure title</p></li>
<li><p><strong>choropleth</strong> (<em>bool</em>) – turn on if plotting choropleth plots</p></li>
<li><p><strong>geojson</strong> (<em>string</em>) – path to GeoJSON file describing the geographic features of the metapopulation</p></li>
<li><p><strong>fontsize</strong> (<em>float</em>) – font size</p></li>
<li><p><strong>figsize</strong> (<em>tupple</em>) – figure size</p></li>
<li><p><strong>vmin</strong> (<em>float</em>) – minimum value of the color bar</p></li>
<li><p><strong>vmax</strong> (<em>float</em>) – maximum value of the color bar</p></li>
<li><p><strong>restrained_patches</strong> (<em>list</em>) – index of the patches (nodes) restrained</p></li>
<li><p><strong>true_origin</strong> (<em>int</em>) – index for the true origin node</p></li>
<li><p><strong>obs_size</strong> (<em>float</em>) – marker size for the observation nodes</p></li>
<li><p><strong>obs_color</strong> (<em>string</em>) – marker color for the observation nodes</p></li>
<li><p><strong>org_color</strong> (<em>tensor with dtype tf.float32</em>) – marker size for the true origin node</p></li>
<li><p><strong>colormap</strong> (<em>string</em>) – Matplotlib colormaps</p></li>
<li><p><strong>ax</strong> – <code class="docutils literal notranslate"><span class="pre">matplotlib.axes.AxesSubplot</span></code>. Defaults to a new axis.</p></li>
<li><p><strong>projection</strong> – the projection to use. For reference see
<a class="reference external" href="https://residentmario.github.io/geoplot/user_guide/Working_with_Projections.html">Working with Projections</a>.</p></li>
<li><p><strong>show_legend</strong> (<em>bool</em>) – show legend for true origin or obsevations.</p></li>
<li><p><strong>show_cbar</strong> (<em>bool</em>) – show heatmap color bar</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.patch_quantile">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">patch_quantile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_traj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_q_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3333333333333333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_q_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6666666666666666</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrained_patches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_fxns_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(18,</span> <span class="pre">18)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fancy_shading</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_shading_gradients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yscale_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw_args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.patch_quantile" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Does <code class="docutils literal notranslate"><span class="pre">traj_quantile</span></code> for trajectories of shape [N, T, M, C] where N is the number of samples, T is the number of timesteps,</dt><dd><p>M is the number of patches (nodes) and C is the number of compartments.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajs</strong> (<em>tensor with dtype tf.float32</em><em> of </em><em>shape</em><em> [</em><em>N</em><em>, </em><em>T</em><em>, </em><em>M</em><em>, </em><em>C</em><em>] </em><em>where N is the number</em><em> of </em><em>samples</em><em>, </em><em>T is the number</em><em> of </em><em>timesteps</em><em>,
</em><em>M is the number</em><em> of </em><em>patches</em><em> (</em><em>nodes</em><em>) </em><em>and C is the number</em><em> of </em><em>compartments.</em>) – ensemble of trajectories after sampling</p></li>
<li><p><strong>ref_traj</strong> (<em>tensor with dtype tf.float32</em><em> of </em><em>shape</em><em> [</em><em>1</em><em>, </em><em>T</em><em>, </em><em>M</em><em>, </em><em>C</em><em>] </em><em>where T is the number</em><em> of </em><em>timesteps</em><em>,
</em><em>M is the number</em><em> of </em><em>patches</em><em> (</em><em>nodes</em><em>) </em><em>and C is the number</em><em> of </em><em>compartments.</em>) – reference trajectory</p></li>
<li><p><strong>weights</strong> (<em>tensor with dtype tf.float32</em>) – weights for the each trajectory in the ensemble. If not defined uniform weights will be assumed.</p></li>
<li><p><strong>lower_q_bound</strong> (<em>float</em>) – lower quantile bound</p></li>
<li><p><strong>upper_q_bound</strong> (<em>float</em>) – upper quantile bound</p></li>
<li><p><strong>restrained_patches</strong> (<em>list</em>) – index of the patches (nodes) restrained</p></li>
<li><p><strong>plot_fxns_list</strong> (<em>list</em>) – output of <cite>compartment_restrainer</cite></p></li>
<li><p><strong>figsize</strong> (<em>tupple</em>) – figure size</p></li>
<li><p><strong>patch_names</strong> (<em>list</em>) – name of the patches (nodes). If not provided patches name will be defined by their index.</p></li>
<li><p><strong>fancy_shading</strong> (<em>bool</em>) – allows for gradient shading of the confidence interval</p></li>
<li><p><strong>n_shading_gradients</strong> (<em>int</em>) – number of intervals for shading gradients</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – alpha value for edges that allows transparency</p></li>
<li><p><strong>obs_color</strong> (<em>string</em>) – marker color for the observation nodes</p></li>
<li><p><strong>yscale_log</strong> (<em>bool</em>) – change y axis scale to log for better visualization of the observations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.plot_dist">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">plot_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A_I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I_R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_exposed_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prior'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.plot_dist" title="Permalink to this definition"></a></dt>
<dd><p>plots a <code class="docutils literal notranslate"><span class="pre">seaborn.distplot</span></code> for the model’s prior parameter distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>R_dist</strong> – sampled mobility flows as tensor with dtype tf.float32</p></li>
<li><p><strong>E_A</strong> – time for going from E-&gt;A as tensor with dtype tf.float32</p></li>
<li><p><strong>A_I</strong> – time for going from A-&gt;I as tensor with dtype tf.float32</p></li>
<li><p><strong>I_R</strong> – time for going from I-&gt;R as tensor with dtype tf.float32</p></li>
<li><p><strong>start_exposed_dist</strong> – starting exposed fraction as tensor with dtype tf.float32</p></li>
<li><p><strong>beta_dist</strong> – beta value(s) as tensor with dtype tf.float32</p></li>
<li><p><strong>name</strong> (<em>string</em>) – name for the distributions that shows up in the figure title</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.sparse_graph_mobility">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">sparse_graph_mobility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sparse_graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fully_connected_mobility_matrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.sparse_graph_mobility" title="Permalink to this definition"></a></dt>
<dd><p>Generates a sprase mobility matrix based on sparse graph and a fully connected mobility matrix inputs.
For a fully connected graph, the output mobility matrix remains the same.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – networkx sparse graph</p></li>
<li><p><strong>fully_connected_mobility_matrix</strong> (<em>numpy array</em>) – [M, M] array with values defining mobility flows between nodes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sparsed mobility matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.traj_loss">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">traj_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_traj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.traj_loss" title="Permalink to this definition"></a></dt>
<dd><p>Returns Kullback–Leibler (KL) divergence loss for predicted traj based on a reference traj and MaxEnt reweighted trajs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_traj</strong> (<em>a</em><em> [</em><em>1</em><em>, </em><em>T</em><em>, </em><em>M</em><em>, </em><em>C</em><em>] </em><em>tensor with dtype tf.float32</em><em>, </em><em>where T is the number</em><em> of </em><em>timesteps</em><em>, </em><em>M is the number</em><em> of </em><em>patches</em><em> (</em><em>nodes</em><em>) </em><em>and
C is the number</em><em> of </em><em>compartments.</em>) – reference traj</p></li>
<li><p><strong>trajs</strong> (<em>a</em><em> [</em><em>N</em><em>, </em><em>T</em><em>, </em><em>M</em><em>, </em><em>C</em><em>] </em><em>tensor with dtype tf.float32</em><em>, </em><em>where N is the number</em><em> of </em><em>samples</em><em>, </em><em>T is the number</em><em> of </em><em>timesteps</em><em>,
</em><em>M is the number</em><em> of </em><em>patches</em><em> (</em><em>nodes</em><em>) </em><em>and C is the number</em><em> of </em><em>compartments</em>) – sampled ensemble of trajectories</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>KL divergence as a scalar value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.traj_quantile">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">traj_quantile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_q_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3333333333333333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_q_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6666666666666666</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(9,</span> <span class="pre">9)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_means</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fancy_shading</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_shading_gradients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.traj_quantile" title="Permalink to this definition"></a></dt>
<dd><p>Make a plot of all the trajectories and the average trajectory based on trajectory weights and lower and upper quantile values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajs</strong> (<em>tensor with dtype tf.float32</em><em> of </em><em>shape</em><em> [</em><em>N</em><em>, </em><em>T</em><em>, </em><em>M</em><em>, </em><em>C</em><em>] </em><em>where N is the number</em><em> of </em><em>samples</em><em>, </em><em>T is the number</em><em> of </em><em>timesteps</em><em>,
</em><em>M is the number</em><em> of </em><em>patches</em><em> (</em><em>nodes</em><em>) </em><em>and C is the number</em><em> of </em><em>compartments.</em>) – ensemble of trajectories after sampling</p></li>
<li><p><strong>weights</strong> (<em>tensor with dtype tf.float32</em>) – weights for the each trajectory in the ensemble. If not defined uniform weights will be assumed.</p></li>
<li><p><strong>lower_q_bound</strong> (<em>float</em>) – lower quantile bound</p></li>
<li><p><strong>upper_q_bound</strong> (<em>float</em>) – upper quantile bound</p></li>
<li><p><strong>figsize</strong> (<em>tupple</em>) – figure size</p></li>
<li><p><strong>names</strong> (<em>list</em>) – name of compartments as strings</p></li>
<li><p><strong>plot_means</strong> (<em>bool</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code> approximates quantiles as distance from median applied to mean.</p></li>
<li><p><strong>ax</strong> – <code class="docutils literal notranslate"><span class="pre">matplotlib.axes.AxesSubplot</span></code>. Defaults to a new axis.</p></li>
<li><p><strong>add_legend</strong> (<em>bool</em>) – show legend</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – alpha value for edges that allows transparency</p></li>
<li><p><strong>fancy_shading</strong> (<em>bool</em>) – allows for gradient shading of the confidence interval</p></li>
<li><p><strong>n_shading_gradients</strong> (<em>int</em>) – number of intervals for shading gradients</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.traj_to_restraints">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">traj_to_restraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_traj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_slice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'r'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.traj_to_restraints" title="Permalink to this definition"></a></dt>
<dd><p>Creates npoints restraints based on given trajectory with multiplicative noise and time averaging.
For example, it could be weekly averages with some noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_traj</strong> (<em>a</em><em> [</em><em>1</em><em>, </em><em>T</em><em>, </em><em>M</em><em>, </em><em>C</em><em>] </em><em>tensor with dtype tf.float32</em><em>, </em><em>where T is the number</em><em> of </em><em>timesteps</em><em>, </em><em>M is the number</em><em> of </em><em>patches</em><em> (</em><em>nodes</em><em>) </em><em>and
C is the number</em><em> of </em><em>compartments.</em>) – reference traj</p></li>
<li><p><strong>inner_slice</strong> (<em>list</em>) – list of length 2. First index determines the patch and second index determines what compartment on that patch is restrained.</p></li>
<li><p><strong>npoints</strong> (<em>int</em>) – number of data points in each restrained compartment</p></li>
<li><p><strong>prior</strong> (<em>maxent.prior</em>) – Prior distribution for expected deviation from target for restraint. Can be either ‘EmptyPrior’ for exact agreement
or set to ‘Laplace’ for more allowable disagreement.</p></li>
<li><p><strong>noise</strong> (<em>float</em>) – multiplicative noise to be added to observations to allow higher uncertainty</p></li>
<li><p><strong>time_average</strong> (<em>int</em>) – number of timesteps to for time averaging of restraints</p></li>
<li><p><strong>start_time</strong> (<em>int</em>) – index for the lower time limit of restraints</p></li>
<li><p><strong>end_time</strong> (<em>int</em>) – index for the higher time limit of restraints. If not provided, maximum timestep will be assumed.</p></li>
<li><p><strong>marker_size</strong> (<em>int</em>) – marker size for restraints</p></li>
<li><p><strong>marker_color</strong> (<em>string</em>) – marker color for restraints</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of restraints, list of functions which take a matplotlib axis and lambda value and plot the restraint on it.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.weighted_exposed_prob_finder">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">weighted_exposed_prob_finder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prior_exposed_patch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_pop_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.weighted_exposed_prob_finder" title="Permalink to this definition"></a></dt>
<dd><p>Finds the weighted probability of being exposed in every patch at time zero across all the sample trajs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prior_exposed_patch</strong> (<em>an array</em><em> of </em><em>size N</em><em> (</em><em>sample size</em><em>)</em>) – output of <code class="docutils literal notranslate"><span class="pre">exposed_finder</span></code> function.</p></li>
<li><p><strong>meta_pop_size</strong> (<em>int</em>) – size of the metapopulation</p></li>
<li><p><strong>weights</strong> (<em>tensor with dtype tf.float32</em>) – weights of the trajectories in the ensemble. If not provided, will be assumed as 1/N.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weighted probability of being exposed across all patches</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="py0.utils.weighted_quantile">
<span class="sig-prename descclassname"><span class="pre">py0.utils.</span></span><span class="sig-name descname"><span class="pre">weighted_quantile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values_sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#py0.utils.weighted_quantile" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Very close to numpy.percentile, but supports weights.</dt><dd><p>Note: quantiles should be in [0, 1]!</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> – numpy.array with data</p></li>
<li><p><strong>quantiles</strong> – array-like with many quantiles needed</p></li>
<li><p><strong>sample_weight</strong> – array-like of the same length as <cite>array</cite></p></li>
<li><p><strong>values_sorted</strong> – bool, if True, then will avoid sorting of
initial array</p></li>
<li><p><strong>old_style</strong> – if True, will correct output to be consistent
with numpy.percentile.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy.array with computed quantiles.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Quick_start.html" class="btn btn-neutral float-left" title="Quick Start" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Mehrad Ansari, Andrew White.
      <span class="lastupdated">Last updated on True.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>